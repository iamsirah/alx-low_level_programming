This is still on nested loops in functions
